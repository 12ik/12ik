define("gondor/toolkit",["lib/jquery","mod/lang","mod/network","mod/cookie","gondor/observer"],function(e,k,i,a,g,b,d){var c,j,f=0,h="http://www.douban.com/stat.html";d.get=e.get;d.post=function(l,n,o,m){if(k.isFunction(n)){m=o;o=n;n={}}return e.ajax({type:"POST",url:l,data:k.mix(n,{ck:a("gck")}),success:o,dataType:m||"text"})};d.getJSON=i.getJSON;d.getRequest=i.getRequest;d.getStyle=i.getStyle;d.getFrame=function(m,l){e('<iframe width="1" height="1" frameborder="0" src="'+m+'" style="visibility:hidden;position:absolute"></iframe>').load(function(){e(this).unbind("load");l(this)}).appendTo("body")};d.getAssets=function(n,l){var m=n.length;n.forEach(function(p){var o=new Image();o.onload=function(){if(l&&--m<=0){l()}o=null};o.src=p})};d.iframeSubmit=function(n,p,l){var m="frameSubmit"+f++;var o=e('<form action="'+n+'" method="POST" target="'+m+'" style="width:1px;height:1px;visibility:hidden;position:absolute"><input type="hidden" name="method" value="auto"><iframe id="'+m+'" name="'+m+'" width="1" height="1" frameborder="0"></iframe></form>').appendTo("body");g.wait("app:autologin",function(){l();o.remove()});o.submit()};d.trackRefuseUser=function(m,l){i.getRequest(h,{gondor:"trackRefuseUser",step:m,env:l})};d.trackPageView=function(l){if(!c){if(!j){j=[];var m=window._gaq=[];m.push(["_setAccount","UA-7019765-9"]);m.push(["_addOrganic","baidu","word"]);m.push(["_addOrganic","soso","w"]);m.push(["_addOrganic","3721","name"]);m.push(["_addOrganic","yodao","q"]);m.push(["_addOrganic","vnet","kw"]);m.push(["_addOrganic","sogou","query"]);m.push(["_addIgnoredOrganic","阿尔法城"]);m.push(["_addIgnoredOrganic","alpahtown"]);m.push(["_addIgnoredOrganic","www.douban.com"]);m.push(["_addIgnoredOrganic","www.alphatown.com"]);m.push(["_trackPageview"]);i.getScript(("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js",function(){j.forEach(function(n){d.trackPageView(n)});j.length=0;c=true})}j.push(l)}else{window._gaq.push(["_trackPageview",l])}}});